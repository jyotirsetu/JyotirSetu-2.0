---
// Horoscope Manager Component
---

<div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
  <div class="bg-white dark:bg-slate-800 rounded-xl shadow-2xl max-w-6xl w-full mx-4 max-h-[90vh] overflow-y-auto">
    <!-- Header -->
    <div class="flex justify-between items-center p-6 border-b border-blue-200 dark:border-blue-700">
      <div>
        <h2 class="text-2xl font-bold text-gray-900 dark:text-white">♈ Horoscope Manager</h2>
        <p class="text-gray-600 dark:text-gray-400">Manage daily and weekly horoscope predictions</p>
      </div>
      <button
        onclick="closeHoroscopeManager()"
        class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-200 text-2xl font-bold"
      >
        ×
      </button>
    </div>

    <!-- Content -->
    <div class="p-6">
      <!-- Create New Horoscope -->
      <div class="bg-blue-50 dark:bg-blue-900/20 rounded-lg p-6 mb-6">
        <h3 class="text-lg font-semibold text-blue-900 dark:text-blue-100 mb-4">Create New Horoscope</h3>
        <form id="new-horoscope-form" class="space-y-4">
          <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Zodiac Sign</label>
              <select
                id="horoscope-sign"
                required
                class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white"
              >
                <option value="">Select zodiac sign</option>
                <option value="Aries">♈ Aries (Mar 21 - Apr 19)</option>
                <option value="Taurus">♉ Taurus (Apr 20 - May 20)</option>
                <option value="Gemini">♊ Gemini (May 21 - Jun 20)</option>
                <option value="Cancer">♋ Cancer (Jun 21 - Jul 22)</option>
                <option value="Leo">♌ Leo (Jul 23 - Aug 22)</option>
                <option value="Virgo">♍ Virgo (Aug 23 - Sep 22)</option>
                <option value="Libra">♎ Libra (Sep 23 - Oct 22)</option>
                <option value="Scorpio">♏ Scorpio (Oct 23 - Nov 21)</option>
                <option value="Sagittarius">♐ Sagittarius (Nov 22 - Dec 21)</option>
                <option value="Capricorn">♑ Capricorn (Dec 22 - Jan 19)</option>
                <option value="Aquarius">♒ Aquarius (Jan 20 - Feb 18)</option>
                <option value="Pisces">♓ Pisces (Feb 19 - Mar 20)</option>
              </select>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Date</label>
              <input
                type="date"
                id="horoscope-date"
                required
                class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white"
              />
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Type</label>
              <select
                id="horoscope-type"
                required
                class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white"
              >
                <option value="">Select type</option>
                <option value="Daily">Daily</option>
                <option value="Weekly">Weekly</option>
                <option value="Monthly">Monthly</option>
                <option value="Yearly">Yearly</option>
              </select>
            </div>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Horoscope Content</label>
            <textarea
              id="horoscope-content"
              required
              rows="6"
              class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-slate-700 dark:text-white"
              placeholder="Enter the horoscope prediction..."
            ></textarea>
          </div>
          <div class="flex items-center space-x-4">
            <button
              type="submit"
              class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg font-medium transition-colors duration-200"
            >
              Create Horoscope
            </button>
            <button
              type="button"
              onclick="clearHoroscopeForm()"
              class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-2 rounded-lg font-medium transition-colors duration-200"
            >
              Clear Form
            </button>
          </div>
        </form>
      </div>

      <!-- Existing Horoscopes -->
      <div>
        <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">Existing Horoscopes</h3>
        <div class="bg-gray-50 dark:bg-gray-700 rounded-lg p-4">
          <div class="space-y-4" id="existing-horoscopes">
            <!-- Horoscopes will be loaded here -->
            <div class="text-center text-gray-500 dark:text-gray-400 py-8">
              <span class="text-4xl">♈</span>
              <p class="mt-2">Loading horoscopes...</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  // Horoscope Manager JavaScript
  let horoscopes = [
    {
      id: 1,
      zodiac_sign: "Aries",
      content: "Today brings exciting opportunities for leadership. Your natural confidence will shine, and others will look to you for guidance. Trust your instincts and take bold action.",
      date: "2024-01-15",
      type: "Daily",
      active: true
    },
    {
      id: 2,
      zodiac_sign: "Taurus",
      content: "Focus on stability and patience today. Financial matters require careful consideration. Your practical nature will help you make wise decisions.",
      date: "2024-01-15",
      type: "Daily",
      active: true
    },
    {
      id: 3,
      zodiac_sign: "Gemini",
      content: "Communication is your strength today. Express your ideas clearly and connect with others. New learning opportunities may arise.",
      date: "2024-01-15",
      type: "Daily",
      active: false
    }
  ];

  // Load existing horoscopes
  function loadExistingHoroscopes() {
    const container = document.getElementById('existing-horoscopes');
    if (!container) return;

    if (horoscopes.length === 0) {
      container.innerHTML = `
        <div class="text-center text-gray-500 dark:text-gray-400 py-8">
          <span class="text-4xl">♈</span>
          <p class="mt-2">No horoscopes created yet</p>
        </div>
      `;
      return;
    }

    container.innerHTML = horoscopes.map(horoscope => `
      <div class="bg-white dark:bg-slate-800 rounded-lg p-4 border border-gray-200 dark:border-gray-600">
        <div class="flex justify-between items-start mb-3">
          <div class="flex-1">
            <div class="flex items-center space-x-3 mb-2">
              <h4 class="font-semibold text-gray-900 dark:text-white text-lg">${horoscope.zodiac_sign}</h4>
              <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200">
                ${horoscope.type}
              </span>
              <span class="text-sm text-gray-500 dark:text-gray-400">${horoscope.date}</span>
              <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${horoscope.active ? 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200' : 'bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200'}">
                ${horoscope.active ? 'Active' : 'Inactive'}
              </span>
            </div>
            <p class="text-gray-600 dark:text-gray-400 leading-relaxed">${horoscope.content}</p>
          </div>
          <div class="flex space-x-2 ml-4">
            <button
              onclick="editHoroscope(${horoscope.id})"
              class="text-blue-600 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 text-sm font-medium"
            >
              Edit
            </button>
            <button
              onclick="toggleHoroscopeStatus(${horoscope.id})"
              class="text-${horoscope.active ? 'red' : 'green'}-600 hover:text-${horoscope.active ? 'red' : 'green'}-700 dark:text-${horoscope.active ? 'red' : 'green'}-400 dark:hover:text-${horoscope.active ? 'red' : 'green'}-300 text-sm font-medium"
            >
              ${horoscope.active ? 'Deactivate' : 'Activate'}
            </button>
            <button
              onclick="deleteHoroscope(${horoscope.id})"
              class="text-red-600 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300 text-sm font-medium"
            >
              Delete
            </button>
          </div>
        </div>
      </div>
    `).join('');
  }

  // Handle new horoscope form submission
  document.getElementById('new-horoscope-form')?.addEventListener('submit', function(e) {
    e.preventDefault();
    
    const signInput = document.getElementById('horoscope-sign') as HTMLSelectElement;
    const dateInput = document.getElementById('horoscope-date') as HTMLInputElement;
    const typeInput = document.getElementById('horoscope-type') as HTMLSelectElement;
    const contentInput = document.getElementById('horoscope-content') as HTMLTextAreaElement;
    
    if (!signInput || !dateInput || !typeInput || !contentInput) return;
    
    const newHoroscope = {
      id: Date.now(),
      zodiac_sign: signInput.value,
      date: dateInput.value,
      type: typeInput.value,
      content: contentInput.value,
      active: true
    };
    
    horoscopes.unshift(newHoroscope);
    loadExistingHoroscopes();
    clearHoroscopeForm();
    
    showNotification('Horoscope created successfully!', 'success');
  });

  // Clear horoscope form
  function clearHoroscopeForm() {
    const signInput = document.getElementById('horoscope-sign') as HTMLSelectElement;
    const dateInput = document.getElementById('horoscope-date') as HTMLInputElement;
    const typeInput = document.getElementById('horoscope-type') as HTMLSelectElement;
    const contentInput = document.getElementById('horoscope-content') as HTMLTextAreaElement;
    
    if (signInput) signInput.value = '';
    if (dateInput) dateInput.value = '';
    if (typeInput) typeInput.value = '';
    if (contentInput) contentInput.value = '';
  }

  // Edit horoscope
  function editHoroscope(id: number) {
    const horoscope = horoscopes.find(h => h.id === id);
    if (!horoscope) return;
    
    // Populate form for editing
    const signInput = document.getElementById('horoscope-sign') as HTMLSelectElement;
    const dateInput = document.getElementById('horoscope-date') as HTMLInputElement;
    const typeInput = document.getElementById('horoscope-type') as HTMLSelectElement;
    const contentInput = document.getElementById('horoscope-content') as HTMLTextAreaElement;
    
    if (signInput) signInput.value = horoscope.zodiac_sign;
    if (dateInput) dateInput.value = horoscope.date;
    if (typeInput) typeInput.value = horoscope.type;
    if (contentInput) contentInput.value = horoscope.content;
    
    // Change form to update mode
    const submitBtn = document.querySelector('#new-horoscope-form button[type="submit"]') as HTMLButtonElement;
    if (submitBtn) {
      submitBtn.textContent = 'Update Horoscope';
      submitBtn.onclick = () => updateHoroscope(id);
    }
  }

  // Update horoscope
  function updateHoroscope(id: number) {
    const signInput = document.getElementById('horoscope-sign') as HTMLSelectElement;
    const dateInput = document.getElementById('horoscope-date') as HTMLInputElement;
    const typeInput = document.getElementById('horoscope-type') as HTMLSelectElement;
    const contentInput = document.getElementById('horoscope-content') as HTMLTextAreaElement;
    
    if (!signInput || !dateInput || !typeInput || !contentInput) return;
    
    const horoscopeIndex = horoscopes.findIndex(h => h.id === id);
    if (horoscopeIndex === -1) return;
    
    horoscopes[horoscopeIndex] = {
      ...horoscopes[horoscopeIndex],
      zodiac_sign: signInput.value,
      date: dateInput.value,
      type: typeInput.value,
      content: contentInput.value
    };
    
    loadExistingHoroscopes();
    clearHoroscopeForm();
    
    // Reset form to create mode
    const submitBtn = document.querySelector('#new-horoscope-form button[type="submit"]') as HTMLButtonElement;
    if (submitBtn) {
      submitBtn.textContent = 'Create Horoscope';
      submitBtn.onclick = null;
    }
    
    showNotification('Horoscope updated successfully!', 'success');
  }

  // Toggle horoscope status
  function toggleHoroscopeStatus(id: number) {
    const horoscopeIndex = horoscopes.findIndex(h => h.id === id);
    if (horoscopeIndex === -1) return;
    
    horoscopes[horoscopeIndex].active = !horoscopes[horoscopeIndex].active;
    loadExistingHoroscopes();
    
    const status = horoscopes[horoscopeIndex].active ? 'activated' : 'deactivated';
    showNotification(`Horoscope ${status} successfully!`, 'success');
  }

  // Delete horoscope
  function deleteHoroscope(id: number) {
    if (confirm('Are you sure you want to delete this horoscope?')) {
      horoscopes = horoscopes.filter(h => h.id !== id);
      loadExistingHoroscopes();
      showNotification('Horoscope deleted successfully!', 'success');
    }
  }

  // Show notification
  function showNotification(message: string, type: 'success' | 'error') {
    const notification = document.createElement('div');
    notification.className = `fixed top-4 right-4 px-6 py-3 rounded-lg text-white font-medium z-50 ${
      type === 'success' ? 'bg-green-500' : 'bg-red-500'
    }`;
    notification.textContent = message;
    
    document.body.appendChild(notification);
    
    setTimeout(() => {
      notification.remove();
    }, 3000);
  }

  // Close horoscope manager
  function closeHoroscopeManager() {
    const modal = document.querySelector('.fixed.inset-0');
    if (modal) {
      modal.remove();
    }
  }

  // Load horoscopes when component mounts
  document.addEventListener('DOMContentLoaded', loadExistingHoroscopes);
</script>
